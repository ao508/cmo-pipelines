MAILTO=cbioportal-pipelines@cbio.mskcc.org
*/15 * * * * . /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/import-portal-users.sh > /dev/null 2>&1 || echo "Failure in crontab: import-portal-users.sh exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
* * * * * /usr/bin/flock -n /data/portal-cron/cron-lock/import-users.lock -c ". /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/import-portal-users-genie.sh > /dev/null 2>&1 || echo \"Failure in crontab: import-portal-users-genie.sh exited with non-zero exit status\" | mail -r \"cbioportal-pipelines@cbio.mskcc.org\" -s \"Failure in crontab\" cbioportal-pipelines@cbio.mskcc.org"
# MSK-IMPACT fetch occurs at 3AM - do not overlap this job with it as mercurial conflicts can occur
0 0,12,13,14,15,16,17,18,19,20,21,22,23 * * * /usr/bin/flock -n /data/portal-cron/cron-lock/cronjob.lock -c ". /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/import-cmo-data-triage.sh >> /data/portal-cron/logs/import-cmo-data-triage.log 2>&1 || echo \"Failure in crontab: import-cmo-data-triage.sh exited with non-zero exit status\" | mail -r \"cbioportal-pipelines@cbio.mskcc.org\" -s \"Failure in crontab\" cbioportal-pipelines@cbio.mskcc.org"
#min hr * * * /usr/bin/flock -n /data/portal-cron/cron-lock/cronjob.lock -c ". /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/import-cmo-data-triage.sh >> /data/portal-cron/logs/import-cmo-data-triage.log 2>&1"
0 1 * * * . /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/import-cmo-data-msk.sh >> /data/portal-cron/logs/import-cmo-data-msk.log 2>&1 || echo "Failure in crontab: import-cmo-data-msk.sh exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
0 0 * * * . /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/import-public-data.sh >> /data/portal-cron/logs/import-public-data-msk.log 2>&1 || echo "Failure in crontab: import-public-data.sh exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
0 0 * * * . /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/import-genie-data.sh >> /data/portal-cron/logs/import-genie-data-msk.log 2>&1 || echo "Failure in crontab: import-genie-data.sh exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
0 2 * * * . /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/import-pdx-data.sh >> /data/portal-cron/logs/import-pdx-data.log 2>&1 || echo "Failure in crontab: import-pdx-data.sh exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
0 3 * * * . /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/import-dmp-impact-data.sh >> /data/portal-cron/logs/import-dmp-impact-data.log 2>&1 || echo "Failure in crontab: import-dmp-impact-data.sh exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
0 0 * * * /usr/sbin/logrotate -f -s /data/portal-cron/logrotate.status /data/portal-cron/portal-cron-logrotate
# use logrotate instead (clean log files older than 8 days every Sunday at midnight)
#0 0 * * 0 find /data/portal-cron/logs/ -maxdepth 1 -type f -name "*.log" -mtime +8 -exec rm -f {} \;
# look into automating the below script, currently run manually
#0 8 * * 5 . /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/glioma-update-check.sh
# CIS login counts
15 0 * * * /data/portal-cron/cis-logins/cbioportal-restful-login-counter.sh `date -d yesterday "+\%m/\%d/\%Y"` /data/portal-cron/cis-logins/cis-logins.csv > /data/portal-cron/logs/cis-logins.log 2>&1 || echo "Failure in crontab: cbioportal-restful-login-counter.sh exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
16 0 * * * /data/portal-cron/cis-logins/cbioportal-restful-login-users.sh `date -d yesterday "+\%m/\%d/\%Y"` /data/portal-cron/cis-logins/cis-users.tsv > /data/portal-cron/logs/cis-users.log 2>&1 || echo "Failure in crontab: cbioportal-restful-login-users.sh exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
0 0 * * 1 . /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/update-gene-data.sh >> /data/portal-cron/logs/update-gene-data.log 2>&1 || echo "Failure in crontab: update-gene-data.sh exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
0 14 * * * /data/portal-cron/scripts/scan-for-stalled-import-jobs.sh >> /data/portal-cron/logs/scan-for-stalled-import-jobs.log 2>&1 || echo "Failure in crontab: scan-for-stalled-import-jobs.sh exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
2 14 * * * . /data/portal-cron/scripts/automation-environment.sh;/data/portal-cron/scripts/test_for_multi_hg_heads.sh >> /data/portal-cron/logs/test-for-multi-hg-heads.log 2>&1 || echo "Failure in crontab: test_for_multi_hg_heads.sh exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
# generate missing oncotree meta links report
0 9 * * 1 /usr/bin/python /data/portal-cron/scripts/missing_oncotree_meta_links.py 2>&1 | mail -r "oncotree-pipelines@cbio.mskcc.org" -s "Missing Oncotree NCI/UMLS codes" oncotree-pipelines@cbio.mskcc.org
# make sure we can execute all scripts, execute daily at midnight
23 55 * * * chmod u+x /data/portal-cron/scripts/*.sh /data/portal-cron/scripts/*.py || echo "Failure in crontab: chmod exited with non-zero exit status" | mail -r "cbioportal-pipelines@cbio.mskcc.org" -s "Failure in crontab" cbioportal-pipelines@cbio.mskcc.org
# REDCap Cron Job (runs every minute)
* * * * * /usr/bin/php /srv/www/html/redcap/cron.php > /dev/null 2>/dev/null
